<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mongo="http://www.springframework.org/schema/data/mongo"
       xsi:schemaLocation="http://www.springframework.org/schema/context
          http://www.springframework.org/schema/context/spring-context.xsd
          http://www.springframework.org/schema/data/mongo
          http://www.springframework.org/schema/data/mongo/spring-mongo.xsd
          http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans.xsd">


    <context:annotation-config/>
    <context:component-scan base-package="com.t2.common.mongo"/>
    <context:component-scan base-package="org.t2k.cgs.dao"/>


    <bean id="storageBean" class="org.t2k.sample.dao.mapStore.MapStore">
        <constructor-arg index="0" value="50"/>
    </bean>

    <mongo:db-factory id="mongoDbFactory"
                      dbname="#{t2kConfig.getProperty('common.mongo.dbName')}"
                      mongo-ref="mongo"
                      username="#{t2kConfig.getProperty('common.mongo.user')}"
                      password="#{t2kConfig.getProperty('common.mongo.password')}"/>

    <mongo:repositories base-package="org.t2k.repository" mongo-template-ref="cgsMongoTemplate"/>

    <bean id="cgsMongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
        <constructor-arg name="mongoDbFactory" ref="mongoDbFactory"/>
        <property name="writeConcern" value="ACKNOWLEDGED"/>
    </bean>

    <bean name="mongoDao" class="org.t2k.cgs.dao.MongoDao" abstract="true">
        <property name="mongoTemplate" ref="cgsMongoTemplate"/>
    </bean>

    <bean name="locksDao" class="org.t2k.cgs.dao.locks.LocksMongoDao" parent="mongoDao"/>
    <bean name="transactionsDao" class="org.t2k.cgs.dao.locks.TransactionsMongoDao" parent="mongoDao"/>
    <bean name="coursesDao" class="org.t2k.cgs.dao.courses.CoursesMongoDao" parent="mongoDao"/>

    <bean name="lessonsDao" class="org.t2k.cgs.dao.tocItem.TocItemsMongoDao" parent="mongoDao">
        <property name="tocItemCollection" value="lessons" />
    </bean>

    <bean name="assessmentsDao" class="org.t2k.cgs.dao.tocItem.TocItemsMongoDao" parent="mongoDao">
        <property name="tocItemCollection" value="assessments" />
    </bean>

    <bean name="userSessionsDao" class="org.t2k.cgs.dao.sessions.UserSessionsMongoDao" parent="mongoDao"/>
    <bean name="fileDao" class="org.t2k.cgs.dao.cms.FileDaoImpl"/>
    <bean name="standardsDao" class="org.t2k.cgs.dao.standards.StandardsMongoDao" parent="mongoDao" />
    <bean name="skillsDao" class="org.t2k.cgs.dao.skills.SkillsMongoDao" parent="mongoDao" />
    <bean name="cleanupsDao" class="org.t2k.cgs.dao.cleanups.CleanupsMongoDao" parent="mongoDao" />
    <bean name="publisherDao" class="org.t2k.cgs.dao.publisher.AccountMongoDao" parent="mongoDao"/>
    <bean name="usersDao" class="org.t2k.cgs.dao.user.UsersMongoDao" parent="mongoDao"/>
    <bean name="packagingDao" class="org.t2k.cgs.dao.packaging.PackagesMongoDao" parent="mongoDao"/>
    <bean name="sequencesDao" class="org.t2k.cgs.dao.sequences.SequencesMongoDao" parent="mongoDao"/>
    <bean name="ttsProviderDao" class="org.t2k.cgs.dao.tts.TextToSpeechProviderMongoDao" parent="mongoDao"/>
    <bean name="bundlesDao" class="org.t2k.cgs.dao.bundles.BundlesMongoDao" parent="mongoDao" />
    <bean name="notificationsDao"  class="org.t2k.cgs.dao.userNotifications.NotificationsMongoDao" parent="mongoDao" />
    <bean name="eBooksDao" class="org.t2k.cgs.dao.ebooks.EBookMongoDao" parent="mongoDao"/>
    <bean id="gcrClient" class="org.t2k.gcr.common.client.GCRClientImpl" init-method="init">
        <property name="gcrCourseUrl" value="#{t2kConfig.getProperty('catalogueUrl')}"/>
        <property name="gcrAppletsUrl" value="#{t2kConfig.getProperty('appletsUrl')}"/>
        <property name="gcrUser" value="#{t2kConfig.getProperty('catalogueUsername')}"/>
        <property name="gcrPassword" value="#{t2kConfig.getProperty('cataloguePassword')}"/>
        <property name="downloadDir" value="#{t2kConfig.getProperty('appletsDownloadDir')}"/>
    </bean>

    <bean name="appletDao" class="org.t2k.cgs.dao.applets.AppletMongoDao" parent="mongoDao"/>
    <bean name="uniqueIdDao" class="org.t2k.cgs.dao.util.UniqueIdMongoDao" parent="mongoDao"/>
    <bean name="jobDao" class="org.t2k.cgs.dao.util.JobsMongoDao" parent="mongoDao"/>
    <bean name="externalPartnersDao" class="org.t2k.cgs.dao.publisher.ExternalPartnersMongoDao" parent="mongoDao" />

</beans>